<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Burrows-Wheeler transform | Genome Assembly</title>
<meta name="author" content="officialprofile">
<meta name="description" content="2.1 Introduction [Description]  2.2 Burrows-Wheeler matrix Consider the following sequence: sequence &lt;- 'GATTACA' In order to create the Burrows-Wheeler matrix for the given string we at first add...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 2 Burrows-Wheeler transform | Genome Assembly">
<meta property="og:type" content="book">
<meta property="og:url" content="https://officialprofile.github.io/Genome-assembly/bwt.html">
<meta property="og:description" content="2.1 Introduction [Description]  2.2 Burrows-Wheeler matrix Consider the following sequence: sequence &lt;- 'GATTACA' In order to create the Burrows-Wheeler matrix for the given string we at first add...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Burrows-Wheeler transform | Genome Assembly">
<meta name="twitter:description" content="2.1 Introduction [Description]  2.2 Burrows-Wheeler matrix Consider the following sequence: sequence &lt;- 'GATTACA' In order to create the Burrows-Wheeler matrix for the given string we at first add...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Low-level approach with R">Genome Assembly</a>:
        <small class="text-muted">Low-level approach with R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="active" href="bwt.html"><span class="header-section-number">2</span> Burrows-Wheeler transform</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="bwt" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Burrows-Wheeler transform<a class="anchor" aria-label="anchor" href="#bwt"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-1" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h2>
<p>[Description]</p>
</div>
<div id="burrows-wheeler-matrix" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Burrows-Wheeler matrix<a class="anchor" aria-label="anchor" href="#burrows-wheeler-matrix"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the following sequence:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sequence</span> <span class="op">&lt;-</span> <span class="st">'GATTACA'</span></code></pre></div>
<p>In order to create the Burrows-Wheeler matrix for the given string we at first add the dollar sign $ at the end of the sequence.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sequence</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="st">'$'</span><span class="op">)</span></code></pre></div>
<p>Afterwards we perform a series of shifts</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span>
<span class="va">n</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">sequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="fl">2</span>, <span class="va">n</span><span class="op">)</span>,
                    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sequences</span>, <span class="va">sequence</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">sequences</span>, sep <span class="op">=</span> <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt; GATTACA$</span>
<span class="co">#&gt; ATTACA$G</span>
<span class="co">#&gt; TTACA$GA</span>
<span class="co">#&gt; TACA$GAT</span>
<span class="co">#&gt; ACA$GATT</span>
<span class="co">#&gt; CA$GATTA</span>
<span class="co">#&gt; A$GATTAC</span>
<span class="co">#&gt; $GATTACA</span></code></pre></div>
<p>Then we sort these sequences with the assumption that the dollar sign precedes lexicographically every symbol.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">sequences</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">sequences</span>, sep <span class="op">=</span> <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt; $GATTACA</span>
<span class="co">#&gt; A$GATTAC</span>
<span class="co">#&gt; ACA$GATT</span>
<span class="co">#&gt; ATTACA$G</span>
<span class="co">#&gt; CA$GATTA</span>
<span class="co">#&gt; GATTACA$</span>
<span class="co">#&gt; TACA$GAT</span>
<span class="co">#&gt; TTACA$GA</span></code></pre></div>
<p>By putting every letter</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bw.matrix</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bw.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">bw.matrix</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sequences</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">bw.matrix</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
</tr>
</tbody>
</table></div>
<p>Sequence at the very bottom of the Burrows-Wheeler matrix is called <strong>Burrows-Wheeler transform</strong>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">transform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">bw.matrix</span><span class="op">[</span>,<span class="va">n</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'The Burrows-Wheeler transform of'</span>, 
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="fl">2</span>, <span class="va">n</span><span class="op">)</span>, <span class="st">'is'</span>, <span class="va">transform</span><span class="op">)</span>
<span class="co">#&gt; The Burrows-Wheeler transform of GATTACA is ACTGA$TA</span></code></pre></div>
</div>
<div id="inverse-transform" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Inverse transform<a class="anchor" aria-label="anchor" href="#inverse-transform"><i class="fas fa-link"></i></a>
</h2>
<p>We are going to reconstruct the Burrows-Wheeler matrix and initial sequence itself. In order to do so one as first has to sort the transformed sequence.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">first.sequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">transform</span>, split <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="va">sort</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">first.sequence</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="co">#&gt; [1] "$AAACGTT"</span></code></pre></div>
<p>Note that this string is equal to the first column of the Burrrows-Wheeler transform. Also keep in mind that the characters from last and the first column are adjacent.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bw.inverse</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>, <span class="va">n</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">bw.inverse</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">transform</span>, split <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">bw.inverse</span><span class="op">[</span> ,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">first.sequence</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">8</th>
<th align="left">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">$</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">G</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td align="left">$</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">T</td>
</tr>
</tbody>
</table></div>
<p>In other words, a this point we have a set of 2-mers.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">bw.inverse</span>, <span class="fl">1</span>, 
               <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span>
<span class="va">kmers</span>
<span class="co">#&gt; [1] "A$" "CA" "TA" "GA" "AC" "$G" "TT" "AT"</span></code></pre></div>
<p>Once again, we strictly rely on the fact that Burrows-Wheeler matrix is sorted lexicographically. This allows us to reconstruct the remaining columns.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">kmers</span><span class="op">)</span>
<span class="va">kmers</span>
<span class="co">#&gt; [1] "$G" "A$" "AC" "AT" "CA" "GA" "TA" "TT"</span></code></pre></div>
<p>These 2-mers (k-mers in general) represent first two columns of the Burrows-Wheeler matrix.</p>
<p>We can derive last characters of the 2-mers in the following way:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">kmers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, 
       simplify <span class="op">=</span> <span class="cn">TRUE</span>, USE.NAMES <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] "G" "$" "C" "T" "A" "A" "A" "T"</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">kmers</span>             <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">bw.inverse</span>, <span class="fl">1</span>, 
                             <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span>
  <span class="va">kmers</span>             <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">kmers</span><span class="op">)</span>
  <span class="va">bw.inverse</span><span class="op">[</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">kmers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">i</span><span class="op">)</span>, 
                              simplify <span class="op">=</span> <span class="cn">TRUE</span>, USE.NAMES <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">i</span>
<span class="op">}</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">8</th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
</tr>
</tbody>
</table></div>
<p>Finally we move first column to the very end</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bw.inverse</span><span class="op">[</span>,<span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bw.inverse</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>
<span class="va">bw.inverse</span>       <span class="op">&lt;-</span> <span class="va">bw.inverse</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span><span class="op">[</span><span class="va">n</span><span class="op">]</span> <span class="op">=</span> <span class="va">n</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">bw.inverse</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
</tr>
<tr class="odd">
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">T</td>
<td align="left">T</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">$</td>
<td align="left">G</td>
<td align="left">A</td>
</tr>
</tbody>
</table></div>
<p>One can also verify that bw.matrix and bw.inverse are in fact the same.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">bw.inverse</span> <span class="op">==</span> <span class="va">bw.matrix</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table></div>
<p>Additionally we can encapsulate Burrows-Wheeler transform in a function</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BWT</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="va">sequence</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="st">'$'</span><span class="op">)</span>
  <span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span>
  <span class="va">n</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span>

  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">sequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="fl">2</span>, <span class="va">n</span><span class="op">)</span>,
                     <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sequences</span>, <span class="va">sequence</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">sequences</span><span class="op">)</span> 
  
  <span class="va">bw.matrix</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">bw.matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>

  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="va">bw.matrix</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sequences</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">bw.matrix</span><span class="op">[</span>,<span class="va">n</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">BWT</span><span class="op">(</span><span class="st">'GATTACA'</span><span class="op">)</span>
<span class="co">#&gt; [1] "ACTGA$TA"</span></code></pre></div>
<p>One can verify that this output is equal to result we obteined earlier.</p>
<p>Out of pure curiosity lets check the Burrows-Wheeler transform for a longer sequence.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">BWT</span><span class="op">(</span><span class="st">'ATGCTCGTGCCATCATATAGCGCGCGCGCGATCTCTACGCGCG'</span><span class="op">)</span>
<span class="co">#&gt; [1] "GTTTCCG$TCGGGGGAGGGTTGTCCTCCCCCCATCCAAACCAGA"</span></code></pre></div>
<p>Please note that the input string has no identical characters at adjacent positions whereas in the transformed sequence such situation appears quite often. These substrings of identical characters will allow us represent the sequence in a more condensed manner.</p>
</div>
<div id="applications" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Applications<a class="anchor" aria-label="anchor" href="#applications"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Introduction</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#bwt"><span class="header-section-number">2</span> Burrows-Wheeler transform</a></li>
<li><a class="nav-link" href="#introduction-1"><span class="header-section-number">2.1</span> Introduction</a></li>
<li><a class="nav-link" href="#burrows-wheeler-matrix"><span class="header-section-number">2.2</span> Burrows-Wheeler matrix</a></li>
<li><a class="nav-link" href="#inverse-transform"><span class="header-section-number">2.3</span> Inverse transform</a></li>
<li><a class="nav-link" href="#applications"><span class="header-section-number">2.4</span> Applications</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/01-Burrows-Wheeler-Transform.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/01-Burrows-Wheeler-Transform.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genome Assembly</strong>: Low-level approach with R" was written by officialprofile. It was last built on 2021-08-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
