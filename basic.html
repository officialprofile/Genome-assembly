<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Basic string manipulations | Genome Assembly</title>
<meta name="author" content="officialprofile">
<meta name="description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 3 Basic string manipulations | Genome Assembly">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/officialprofile/Genome-assembly/basic.html">
<meta property="og:description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Basic string manipulations | Genome Assembly">
<meta name="twitter:description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genome Assembly</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction to genome assembly</a></li>
<li><a class="active" href="basic.html"><span class="header-section-number">3</span> Basic string manipulations</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">4</span> Graph theory</a></li>
<li><a class="" href="bruijn.html"><span class="header-section-number">5</span> De Bruijn graph</a></li>
<li><a class="" href="bwt.html"><span class="header-section-number">6</span> Burrows-Wheeler transform</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/officialprofile/Genome-assembly/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basic" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Basic string manipulations<a class="anchor" aria-label="anchor" href="#basic"><i class="fas fa-link"></i></a>
</h1>
<p>Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations. Being able to get through them is in a sense a must, at least from a perspective of algorithms that will be discussed later. On the other hand some of the problems, like generating k-mers or suffixes, are absolutely crucial in genome assembly and one has to know them to a tee. So, without further ado, let’s do the warm up.</p>
<div id="generating-random-dna-sequence" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Generating random DNA sequence<a class="anchor" aria-label="anchor" href="#generating-random-dna-sequence"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s start with writing a function that, for a given integer n &gt; 0, returns randomly generated DNA sequence.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">random_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'C'</span>,<span class="st">'G'</span>,<span class="st">'T'</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">random_sequence</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] "C" "G" "A" "A" "G" "C" "A" "A" "A" "G"</span></code></pre></div>
<p>If we want our returned sequence to be in a form of a single string we can use <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> function with collapse parameter equal to <code>''</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">random_sequence</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="co">#&gt; [1] "GTGTGGCCCT"</span></code></pre></div>
<p>For now we will try to stick to the first form, mainly because base R is not that good at manipulating strings (at this point we try to not employ any additional libraries like stringr). If a <code>DNA</code> is equal to <code>'ACGTG'</code> then we won’t get a substring <code>'CG'</code> simply by writing <code>DNA[2:3]</code> (one could to this in python). On the other hand, if DNA is a vector <code><a href="https://rdrr.io/r/base/c.html">c('A', 'C', 'G', 'T', 'G')</a></code> then <code>DNA[2:3]</code> will return <code><a href="https://rdrr.io/r/base/c.html">c('C', 'G')</a></code> that in turn can be easily merged into <code>'CG'</code>.</p>
</div>
<div id="finding-cdna" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Finding cDNA<a class="anchor" aria-label="anchor" href="#finding-cdna"><i class="fas fa-link"></i></a>
</h2>
<p>One must know that C (cytosine) is complementary to G (guanine), and A (adenine) is complementary to T (thymine). In order to create a cDNA we will at first construct a list (in Python it would be a dictionary) of complementary nucleobases.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">c_bases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'A'</span> <span class="op">=</span> <span class="st">'T'</span>, <span class="st">'C'</span> <span class="op">=</span> <span class="st">'G'</span>, <span class="st">'G'</span> <span class="op">=</span> <span class="st">'C'</span>, <span class="st">'T'</span> <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span>

<span class="va">c_bases</span><span class="op">[</span><span class="st">'A'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "T"</span></code></pre></div>
<p>This data structure will allows us to directly pull out complementary bases. Let’s build a function utilizes this.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">complementary_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="va">complementary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">base</span> <span class="kw">in</span> <span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
    <span class="va">complementary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">complementary</span>, <span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">complementary</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Please note that we append complementary nucleobase in a seemingly non-optimal way, namely <code>sequence = c(sequence, new_nucleobase)</code>. One could argue that this should be done with <code><a href="https://rdrr.io/r/base/append.html">append()</a></code>, i. e. <code>sequence = append(sequence, new_nucleobase)</code>, but in fact the append in R is regarded as a relatively slow function and our solution is usually more recommended.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu">random_sequence</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">' DNA ='</span>, <span class="va">seq</span>, <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt;  DNA = C G C C G C C G T G T G A A T G A C G C</span>
<span class="va">cseq</span> <span class="op">&lt;-</span> <span class="fu">complementary_sequence</span><span class="op">(</span><span class="va">seq</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'cDNA ='</span>, <span class="va">cseq</span><span class="op">)</span>
<span class="co">#&gt; cDNA = G C G G C G G C A C A C T T A C T G C G</span></code></pre></div>
<p>There is also a neater way to compute, and in a way avoid, these kind of loops. One can achieve this though functions like <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>, <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> or <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">complementary_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">seq</span>, <span class="kw">function</span><span class="op">(</span><span class="va">base</span><span class="op">)</span> <span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The clear downside of using functions like the one above is loss of legibility. Applying them can also be not as straightforward and intuitive as writing a conventional loop. Advanced programmers though find these functions very handy, fast and as readable as standard for or while loop. For that reason we will try to balance these two approaches out. We don’t want our code to be too hermetic, but also we should not limit ourselves by deliberately avoiding legitimate solutions.</p>
</div>
<div id="finding-reverse-complementary" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Finding reverse complementary<a class="anchor" aria-label="anchor" href="#finding-reverse-complementary"><i class="fas fa-link"></i></a>
</h2>
<p>Obtaining reverse complementary is very similar. The only difference is that instead of appending complementary nucleobases we will prepend them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reverse_complementary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="va">reverse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">base</span> <span class="kw">in</span> <span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
    <span class="va">reverse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">reverse</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">reverse</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu">random_sequence</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">' DNA ='</span>, <span class="va">seq</span>, <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt;  DNA = C A T T G C C T C T T A T T C T C C T T</span>
<span class="va">rcseq</span> <span class="op">&lt;-</span> <span class="fu">reverse_complementary</span><span class="op">(</span><span class="va">seq</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'cDNA ='</span>, <span class="va">rcseq</span><span class="op">)</span>
<span class="co">#&gt; cDNA = A A G G A G A A T A A G A G G C A A T G</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction.html"><span class="header-section-number">2</span> Introduction to genome assembly</a></div>
<div class="next"><a href="graph.html"><span class="header-section-number">4</span> Graph theory</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic"><span class="header-section-number">3</span> Basic string manipulations</a></li>
<li><a class="nav-link" href="#generating-random-dna-sequence"><span class="header-section-number">3.1</span> Generating random DNA sequence</a></li>
<li><a class="nav-link" href="#finding-cdna"><span class="header-section-number">3.2</span> Finding cDNA</a></li>
<li><a class="nav-link" href="#finding-reverse-complementary"><span class="header-section-number">3.3</span> Finding reverse complementary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/officialprofile/Genome-assembly//blob/master/03-Basic.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/officialprofile/Genome-assembly//edit/master/03-Basic.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genome Assembly</strong>" was written by officialprofile. It was last built on 2021-09-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
