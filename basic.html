<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Basic string manipulations | Genome Assembly</title>
<meta name="author" content="officialprofile">
<meta name="description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Basic string manipulations | Genome Assembly">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/officialprofile/Genome-assembly/basic.html">
<meta property="og:description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Basic string manipulations | Genome Assembly">
<meta name="twitter:description" content="Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genome Assembly</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="active" href="basic.html"><span class="header-section-number">3</span> Basic string manipulations</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">4</span> Graph theory</a></li>
<li><a class="" href="bruijn.html"><span class="header-section-number">5</span> De Bruijn graph</a></li>
<li><a class="" href="bwt.html"><span class="header-section-number">6</span> Burrows-Wheeler transform</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/officialprofile/Genome-assembly/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basic" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Basic string manipulations<a class="anchor" aria-label="anchor" href="#basic"><i class="fas fa-link"></i></a>
</h1>
<p>Before we dive into the main topics let’s warm up with few basic exercises. On the one hand some of these problems might be regarded as a form of general familiarization with string manipulations. Being able to get through them is in a sense a must, at least from a perspective of algorithms that will be discussed later. On the other hand some of the problems, like generating k-mers or suffixes, are absolutely crucial in genome assembly and one has to know them to a tee. So, without further ado, let’s do the warm up.</p>
<div id="generae-random-dna-sequence" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Generae random DNA sequence<a class="anchor" aria-label="anchor" href="#generae-random-dna-sequence"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s start with writing a function that, for a given integer n &gt; 0, returns randomly generated DNA sequence.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">random_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'C'</span>,<span class="st">'G'</span>,<span class="st">'T'</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">random_sequence</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] "C" "C" "T" "A" "G" "C" "C" "G" "T" "T"</span></code></pre></div>
<p>If we want our returned sequence to be in a form of a single string we can use <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> function with collapse parameter equal to <code>''</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">random_sequence</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="co">#&gt; [1] "CTCACGGAAA"</span></code></pre></div>
<p>Unfortunately, there is no a convenient way of retrieving a substring. If a <code>DNA</code> variable is equal to <code>'ACGTG'</code> then we won’t get a substring <code>'CG'</code> simply by writing <code>DNA[2:3]</code> (one could to this in python). One could do this by employing the <code><a href="https://rdrr.io/r/base/substr.html">substr()</a></code> function, i.e. <code><a href="https://rdrr.io/r/base/substr.html">substr(DNA, 2, 3)</a></code>. On the other hand, if DNA is a vector <code><a href="https://rdrr.io/r/base/c.html">c('A', 'C', 'G', 'T', 'G')</a></code> then <code>DNA[2:3]</code> will return <code><a href="https://rdrr.io/r/base/c.html">c('C', 'G')</a></code> that in turn can be merged into <code>'CG'</code> by <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>. Either way, one must use a certain function in order to glue the letters or to split the sequence.</p>
</div>
<div id="find-cdna" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Find cDNA<a class="anchor" aria-label="anchor" href="#find-cdna"><i class="fas fa-link"></i></a>
</h2>
<p>To find the complementary sequence one must know that C (cytosine) is complementary to G (guanine), and A (adenine) is complementary to T (thymine). Also, before creating the cDNA we will at first construct a list (in Python it would be a dictionary) of complementary nucleobases.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">c_bases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'A'</span> <span class="op">=</span> <span class="st">'T'</span>, <span class="st">'C'</span> <span class="op">=</span> <span class="st">'G'</span>, <span class="st">'G'</span> <span class="op">=</span> <span class="st">'C'</span>, <span class="st">'T'</span> <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span>

<span class="va">c_bases</span><span class="op">[</span><span class="st">'A'</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "T"</span></code></pre></div>
<p>This data structure allows us to directly access complementary bases. Let’s build a function that utilizes this.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">complementary_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="va">complementary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">base</span> <span class="kw">in</span> <span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
    <span class="va">complementary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">complementary</span>, <span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">complementary</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Please note that we append complementary nucleobase in a seemingly non-optimal way, namely by writing <code>sequence = c(sequence, new_nucleobase)</code>. One could argue that this should be done with <code><a href="https://rdrr.io/r/base/append.html">append()</a></code>, i. e. <code>sequence = append(sequence, new_nucleobase)</code>, but in fact the append in R is regarded as a relatively slow function and our solution is usually more recommended (in python using append is fine).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu">random_sequence</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">' DNA ='</span>, <span class="va">seq</span>, <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt;  DNA = A A T G C A G C T G T T A T C A A G G G</span>
<span class="va">cseq</span> <span class="op">&lt;-</span> <span class="fu">complementary_sequence</span><span class="op">(</span><span class="va">seq</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'cDNA ='</span>, <span class="va">cseq</span><span class="op">)</span>
<span class="co">#&gt; cDNA = T T A C G T C G A C A A T A G T T C C C</span></code></pre></div>
<p>There is also a neater way to compute, and in a way avoid, these kind of loops. One can achieve this though functions like <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>, <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> or <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">complementary_sequence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">seq</span>, <span class="kw">function</span><span class="op">(</span><span class="va">base</span><span class="op">)</span> <span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The clear downside of using functions like the one above is loss of legibility. Applying them can also be not as straightforward and intuitive as writing a conventional loop. Advanced programmers though find these functions very handy, fast and as readable as standard for or while loop. For that reason we will try to balance these two approaches out. We don’t want our code to be too hermetic, but also we should not limit ourselves by deliberately avoiding legitimate solutions.</p>
</div>
<div id="find-reverse-complementary" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Find reverse complementary<a class="anchor" aria-label="anchor" href="#find-reverse-complementary"><i class="fas fa-link"></i></a>
</h2>
<p>Obtaining reverse complementary is very similar. The only difference is that instead of appending complementary nucleobases we will prepend them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reverse_complementary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
  <span class="va">reverse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">base</span> <span class="kw">in</span> <span class="va">sequence</span><span class="op">)</span><span class="op">{</span>
    <span class="va">reverse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">c_bases</span><span class="op">[</span><span class="va">base</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">reverse</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">reverse</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seq</span> <span class="op">&lt;-</span> <span class="fu">random_sequence</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">' DNA ='</span>, <span class="va">seq</span>, <span class="st">'\n'</span><span class="op">)</span>
<span class="co">#&gt;  DNA = C G G G C T T G G C T T C T A C T C G T</span>
<span class="va">rcseq</span> <span class="op">&lt;-</span> <span class="fu">reverse_complementary</span><span class="op">(</span><span class="va">seq</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'cDNA ='</span>, <span class="va">rcseq</span><span class="op">)</span>
<span class="co">#&gt; cDNA = A C G A G T A G A A G C C A A G C C C G</span></code></pre></div>
</div>
<div id="calculate-frequency-of-the-nucleobases" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Calculate frequency of the nucleobases<a class="anchor" aria-label="anchor" href="#calculate-frequency-of-the-nucleobases"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frequency</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence</span>, <span class="va">percents</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>
  <span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sequence</span><span class="op">)</span>
  <span class="va">divide_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">percents</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">counts</span><span class="op">/</span><span class="va">divide_counts</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">seq</span>, percents <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; sequence</span>
<span class="co">#&gt;    A    C    G    T </span>
<span class="co">#&gt; 0.05 0.30 0.30 0.35</span></code></pre></div>
</div>
<div id="longest-common-prefix" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Longest common prefix<a class="anchor" aria-label="anchor" href="#longest-common-prefix"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">longest_common_prefix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence1</span>, <span class="va">sequence2</span><span class="op">)</span><span class="op">{</span>
  <span class="va">min_length</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sequence1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sequence2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">index</span> <span class="op">=</span> <span class="fl">0</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="va">sequence2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="st">'No common prefix'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">min_length</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">sequence2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">min_length</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">longest_common_prefix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'C'</span>,<span class="st">'T'</span>,<span class="st">'G'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'T'</span>, <span class="st">'T'</span>, <span class="st">'T'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "A" "C" "T"</span>

<span class="fu">longest_common_prefix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'C'</span>,<span class="st">'C'</span>,<span class="st">'T'</span>,<span class="st">'G'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'T'</span>, <span class="st">'T'</span>, <span class="st">'T'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "No common prefix"</span></code></pre></div>
<p>Imputing strings that are in fact consisted of vectors of characters may not be particularly convenient. We will therefore add a functionally that detects type of inputs and converts them if it is needed.</p>
<p>Unfortunately, R does not differentiates between <code><a href="https://rdrr.io/r/base/c.html">c('a','c','t','g')</a></code> and <code>'ACTG'</code>, e.g.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'G'</span>, <span class="st">'T'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "character"</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="st">'ACGT'</span><span class="op">)</span>
<span class="co">#&gt; [1] "character"</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'G'</span>, <span class="st">'T'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 4</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="st">'ACGT'</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
<p>On this account we will simply add new boolean argument <code>glued</code> to our function. This solution is far from perfect, but for now is good enough.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">longest_common_prefix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sequence1</span>, <span class="va">sequence2</span>, <span class="va">glued</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">glued</span><span class="op">)</span><span class="op">{</span>
    <span class="va">sequence1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sequence1</span>, <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="va">sequence2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">sequence2</span>, <span class="st">''</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="va">min_length</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sequence1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sequence2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">index</span> <span class="op">=</span> <span class="fl">0</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="va">sequence2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="st">'No common prefix'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">min_length</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">sequence2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">sequence1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">min_length</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">longest_common_prefix</span><span class="op">(</span><span class="st">'ACTG'</span>, <span class="st">'ACCC'</span>, glued <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "A" "C"</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction.html"><span class="header-section-number">2</span> Introduction</a></div>
<div class="next"><a href="graph.html"><span class="header-section-number">4</span> Graph theory</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic"><span class="header-section-number">3</span> Basic string manipulations</a></li>
<li><a class="nav-link" href="#generae-random-dna-sequence"><span class="header-section-number">3.1</span> Generae random DNA sequence</a></li>
<li><a class="nav-link" href="#find-cdna"><span class="header-section-number">3.2</span> Find cDNA</a></li>
<li><a class="nav-link" href="#find-reverse-complementary"><span class="header-section-number">3.3</span> Find reverse complementary</a></li>
<li><a class="nav-link" href="#calculate-frequency-of-the-nucleobases"><span class="header-section-number">3.4</span> Calculate frequency of the nucleobases</a></li>
<li><a class="nav-link" href="#longest-common-prefix"><span class="header-section-number">3.5</span> Longest common prefix</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/officialprofile/Genome-assembly//blob/master/03-Basic.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/officialprofile/Genome-assembly//edit/master/03-Basic.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genome Assembly</strong>" was written by officialprofile. It was last built on 2021-09-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
